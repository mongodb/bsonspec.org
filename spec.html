<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<head>
  <title>BSON (Binary JSON): Specification</title>
  <link rel="stylesheet" href="css/spec.css" type="text/css">
</head>

<body>
  <h2 class="nojs">Specification Version 1.1</h2>

  <p>BSON is a binary format in which zero or more ordered key/value
    pairs are stored as a single entity. We call this entity
    a <em>document</em>.</p>

  <p>The following grammar specifies version 1.1 of the
    BSON standard. We've written the grammar using a
    pseudo-<a href="http://en.wikipedia.org/wiki/Backus%E2%80%93Naur_Form">BNF</a>
    syntax. Valid BSON data is represented by
    the <code>document</code> non-terminal.</p>

  <div id="grammar">
    <h3>Basic Types</h3>

    <p>The following basic types are used as terminals in
      the rest of the grammar. Each type must be serialized in
      little-endian format.</p>

    <div class="tb">
      <table>
        <tr>
          <td class="t">byte</td>
          <td>1 byte (8-bits)</td>
        </tr>
        <tr>
          <td class="t">signed_byte(n)</td>
          <td>8-bit, two's complement signed integer for which the value is <code>n</code>.</td>
        </tr>
        <tr>
          <td class="t">unsigned_byte(n)</td>
          <td>8-bit unsigned integer for which the value is <code>n</code>.</td>
        </tr>
        <tr>
          <td class="t">int32</td>
          <td>4 bytes (32-bit signed integer, two's complement)</td>
        </tr>
        <tr>
          <td class="t">int64</td>
          <td>8 bytes (64-bit signed integer, two's complement)</td>
        </tr>
        <tr>
          <td class="t">uint64</td>
          <td>8 bytes (64-bit unsigned integer)</td>
        </tr>
        <tr>
          <td class="t">double</td>
          <td>8 bytes (64-bit IEEE 754-2008 binary floating point)</td>
        </tr>
        <tr>
          <td class="t">decimal128</td>
          <td>16 bytes (128-bit IEEE 754-2008 decimal floating point)</td>
        </tr>
      </table>
    </div>

    <h3>Non-terminals</h3>

    <p>The following specifies the rest of the BSON
      grammar. Note that we use the <code>*</code> operator as
      shorthand for repetition (e.g. <code>(byte*2)</code>
      is <code>byte byte</code>). When used as a unary
      operator, <code>*</code> means that the repetition can
      occur 0 or more times.</p>

    <div class="tb">
      <table>
        <tr>
          <td class="fix nt">document</td>
          <td class="fix op">::=</td>
          <td class="fix ex">int32 e_list unsigned_byte(0)</td>
          <td>BSON Document. <code>int32</code> is the total number of bytes constituting the document.</td>
        </tr>
        <tr class="section">
          <td class="fix nt">e_list</td>
          <td class="fix op">::=</td>
          <td class="fix ex">element e_list</td>
          <td></td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">""</td>
          <td></td>
        </tr>
        <tr class="section">
          <td class="fix nt">element</td>
          <td class="fix op">::=</td>
          <td style="width:35%" class="fix ex">signed_byte(1) e_name double</td>
          <td>64-bit binary floating point</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">signed_byte(2) e_name string</td>
          <td>UTF-8 string</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">signed_byte(3) e_name document</td>
          <td>Embedded document</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">signed_byte(4) e_name document</td>
          <td>Array. A normal BSON document with integer values for the keys, starting at 0 and continuing sequentially. For example, the array <code>['red', 'blue']</code> encodes as the document <code>{'0': 'red', '1': 'blue'}</code>.</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">signed_byte(5) e_name binary</td>
          <td>Binary data</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">signed_byte(6) e_name</td>
          <td><em>Deprecated. </em> Undefined (value)</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">signed_byte(7) e_name (byte*12)</td>
          <td><a href="https://www.mongodb.com/docs/manual/reference/bson-types/#objectid">ObjectId</a></td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">signed_byte(8) e_name unsigned_byte(0)</td>
          <td>Boolean (false)</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">signed_byte(8) e_name unsigned_byte(1)</td>
          <td>Boolean (true)</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">signed_byte(9) e_name int64</td>
          <td>UTC datetime. <code>int64</code> is UTC milliseconds since the Unix epoch.</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">signed_byte(10) e_name</td>
          <td>Null value</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">signed_byte(11) e_name cstring cstring</td>
          <td>Regular expression. See below for more information.
          </td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">signed_byte(12) e_name string (byte*12)</td>
          <td>DBPointer</td>. <em>Deprecated.</em> 
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">signed_byte(13) e_name string</td>
          <td>JavaScript code</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">signed_byte(14) e_name string</td>
          <td>Symbol. <em>Deprecated.</em></td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">signed_byte(15) e_name code_w_s</td>
          <td>JavaScript code with scope. <em>Deprecated.</em></td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">signed_byte(16) e_name int32</td>
          <td>32-bit integer</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">signed_byte(17) e_name uint64</td>
          <td>Timestamp. Special internal type used by MongoDB replication and sharding. First 4 bytes are an increment, second 4 are a timestamp.</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">signed_byte(18) e_name int64</td>
          <td>64-bit integer</td>
        </tr>
        <tr class="section">
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">signed_byte(19) e_name decimal128</td>
          <td><a
              href="https://github.com/mongodb/specifications/blob/master/source/bson-decimal128/decimal128.rst">128-bit
              decimal floating point</a></td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">signed_byte(-1) e_name</td>
          <td>Min key. Special type that compares lower than all other possible BSON element values.</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">signed_byte(127) e_name</td>
          <td>Max key. Special type that compares higher than all other possible BSON element values.</td>
        </tr>
        <tr class="section">
          <td class="fix nt">e_name</td>
          <td class="fix op">::=</td>
          <td class="fix ex">cstring</td>
          <td>Key name</td>
        </tr>
        <tr class="section">
          <td class="fix nt">string</td>
          <td class="fix op">::=</td>
          <td class="fix ex">int32 (byte*) unsigned_byte(0)</td>
          <td>String. The <code>int32</code> is the number of bytes in the
            <code>(byte*)</code> plus one for the trailing null byte. The <code>(byte*)</code> is
            zero or more UTF-8 encoded characters.</td>
        </tr>
        <tr class="section">
          <td class="fix nt">cstring</td>
          <td class="fix op">::=</td>
          <td class="fix ex">(byte*) unsigned_byte(0)</td>
          <td>Zero or more modified UTF-8 encoded characters
            followed by the null byte. The <code>(byte*)</code> MUST NOT contain
            <code>unsigned_byte(0)</code>, hence it is not full UTF-8.
          </td>
        </tr>
        <tr class="section">
          <td class="fix nt">binary</td>
          <td class="fix op">::=</td>
          <td class="fix ex">int32 subtype (byte*)</td>
          <td>BSON binary or <code>BinData</code>. An array of bytes, similar to a Java <code>ByteArray</code>. The <code>int32</code> is the number of bytes in the <code>(byte*)</code>. The <em>subtype</em> indicates the kind of data in the byte array. See below for more information.</td>
        </tr>
        <tr class="section">
          <td class="fix nt">subtype</td>
          <td class="fix op">::=</td>
          <td class="fix ex">unsigned_byte(0)</td>
          <td>Generic binary subtype. This is the most commonly used binary subtype and should be the 'default' for drivers and tools.</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">unsigned_byte(1)</td>
          <td>Function</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">unsigned_byte(2)</td>
          <td>Binary (Old). <em>Deprecated</em> in favor of subtype 0. See below for more information.</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">unsigned_byte(3)</td>
          <td>UUID (Old). <em>Deprecated</em> in favor of subtype 4. Drivers and tools for languages with a native UUID type should properly handle subtype 3.</li>  
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">unsigned_byte(4)</td>
          <td>UUID</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">unsigned_byte(5)</td>
          <td>MD5</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">unsigned_byte(6)</td>
          <td><a
              href="https://github.com/mongodb/specifications/blob/master/source/bson-binary-encrypted/binary-encrypted.md">Encrypted
              BSON value</a></td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">unsigned_byte(7)</td>
          <td>Compressed BSON column, providing compact storage of BSON data. See below for more information.</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">unsigned_byte(8)</td>
          <td>Sensitive</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">unsigned_byte(9)</td>
          <td>Vector</td>
        </tr>
        <tr>
          <td class="fix nt"></td>
          <td class="fix op">|</td>
          <td class="fix ex">unsigned_byte(128)&mdash;unsigned_byte(255)</td>
          <td>User-defined</td>
        </tr>
        <tr class="section">
          <td class="fix nt">code_w_s</td>
          <td class="fix op">::=</td>
          <td class="fix ex">int32 string document</td>
          <td>Code with scope. <em>Deprecated.</em></td>
        </tr>
      </table>
    </div>
  </div>


  <h3>More Information</h3>
  <table style="border-collapse: collapse; width: 100%; border: 1px solid black;">  
      <tr>  
          <th style="border: 1px solid black; padding: 8px; text-align: left;">Non-terminal</th>  
          <th style="border: 1px solid black; padding: 8px; text-align: left;">Description</th>  
      </tr>  
      <tr>  
          <td style="border: 1px solid black; padding: 8px;">Compressed BSON column</td>  
          <td style="border: 1px solid black; padding: 8px;">This data type uses delta and delta-of-delta compression and run-length-encoding for efficient element storage. It also has an encoding for sparse arrays containing missing values.</td>  
      </tr> 
      <tr>  
          <td style="border: 1px solid black; padding: 8px;">Regular expression</td>  
          <td style="border: 1px solid black; padding: 8px;">
            <p>The first <code>cstring</code> is the regex
            pattern. The second <code>cstring</code> is the regex options string.</p>
            <p>Options are identified by characters, which must be stored in
            alphabetical order. Regular expressions support the following options:</p>
            <ul>
              <li><code>i</code> enables case-insensitive matching</li>
              <li><code>m</code> enables multiline matching</li>
              <li><code>s</code> enables <i>dotall</i> mode ("." matches everything)</li>
              <li><code>x</code> enables verbose mode</li>
              <li><code>u</code> enables "\w", "\W", etc. to match Unicode</li>
            </ul> 
          </td>
      </tr>
      <tr>  
          <td style="border: 1px solid black; padding: 8px;">Vector</td>  
          <td style="border: 1px solid black; padding: 8px;">  
              <p>Dense array of mostly non-zero numeric values, effectively used to represent data in artificial intelligence, machine learning, semantic search, computer vision, and natural language processing applications.</p>  
              <p>All values within the vector must be of the same type. Vectors support the following types:</p>  
              <ul>  
                  <li>Packed binary (1-bit unsigned <code>int</code>)</li>  
                  <li>Signed 8-bit integer (<code>int</code>)</li>  
                  <li>32-bit floating point (<code>float</code>)</li>  
              </ul>  
          </td>  
      </tr>  
          <td style="border: 1px solid black; padding: 8px;">Binary (old)</td>  
          <td style="border: 1px solid black; padding: 8px;">  
          Subtype 2 was the default binary subtype before it was deprecated. Drivers and tools should properly handle this subtype.
          The structure of the binary data must be an <code>int32</code> followed by a <code>byte*</code>. The <code>int32</code> is the number of bytes in the repetition.</li>  
          </td>  
      </tr>  
      <tr>  
          <td style="border: 1px solid black; padding: 8px;">Code with scope</td>  
          <td style="border: 1px solid black; padding: 8px;">The <code>int32</code> is the length in bytes of the entire <code>code_w_s</code> value. The string is JavaScript code. The document is a mapping from identifiers to values, representing the scope in which the string should be evaluated.</td>  
      </tr>  
  </table>  


  <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script>
  <script type="text/javascript">
    try {
      var pageTracker = _gat._getTracker("UA-7301842-4");
      pageTracker._trackPageview();
    } catch (err) { }
  </script>
</body>

</html>